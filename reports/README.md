# Результаты экспериментов

Сначала были проведены дополнительные экспермиенты по изменению гиперпараметров, замены функции потерь, изменению оптимизаторов. В основном все эксперименты проводились для датасета **torchgeo**, учитывая маленький размер видеокарты, набор параметров по умолчанию представлен ниже:

| Название          | Значение | Примечание                                                  |
|----------:        |:--------:|:--------:                                                   |
| **batch_size**    | 8        | Подбирался исходя из размеров памяти видеокарты             |
| **img_size**      | 256      | Подбирался исходя из размеров памяти видеокарты             | 
| **iou_thr**       | 0.5      | Смотри эксперимент 1                                        |
| **loss_fns**      | DiceLoss | Смотри эксперимент 3                                        |
| **model_epoch**   | 30       | Смотри эксперимент 2                                        |
| **model_lr**      | 0.0001   | |
| **optimizer**     | Adam     | |
| **train_samp_len**| 640      | Бралась примерно половина от максимально возможно количества|
| **val_samp_len**  | 320      | Бралась примерно половина от максимально возможно количества|


1. Изменение гиперпараметра **IoU threshold**
<a href="/reports/clearml_screens/clearml_1.png"><img src="/reports/clearml_screens/clearml_1.png" style="width: 500px; max-width: 100%; height: auto" title="Click for the larger version." /></a>

Как видно из графиков данный параметр не влияет на метрики и функции потерь.


2. Изменение **количества эпох**
<a href="/reports/clearml_screens/clearml_2.png"><img src="/reports/clearml_screens/clearml_2.png" style="width: 500px; max-width: 100%; height: auto" title="Click for the larger version." /></a>

Как видно из графиков увеличение обучения не влияет на увеличение метрики или уменьшение функции потерь.

3. Изменение **функции потерь**
<a href="/reports/clearml_screens/clearml_3.png"><img src="/reports/clearml_screens/clearml_3.png" style="width: 500px; max-width: 100%; height: auto" title="Click for the larger version." /></a>

Как видно из графиков функция потерь Dice принимает меньшие значения, поэтому она принята за базовую.

4. Изменение **оптимизаторов**
<a href="/reports/clearml_screens/clearml_4.png"><img src="/reports/clearml_screens/clearml_4.png" style="width: 500px; max-width: 100%; height: auto" title="Click for the larger version." /></a>

Как видно из графиков оптимизаторы для данной задачи примерно одинаковы, базовым возьмем **Lion**, так как он самый "свежий".

# Главный эксперимент

**Классический подход VS против torchgeo**

1. Сначала результаты "не правильного" эксперимента. По значениям метрики и функции потерь выиграл - Классический подход. Так как в основном все значения одинаковые, а различается только в размере подаваемых изображений 512 **vs** 256 (классический подход и torchgeo), то скорее всего  нужно увеличить размер изображения для **torchgeo** подхода (так как судя по всему большее изображение дает большее кол-во функций и паттернов для сегментации борщевика). Ведь с точки зрения логики в **torchgeo** мы подаем "большее" количество данных, за счет 2 дополнительных слоев, поэтому и результат должен быть лучше классического подхода.
<a href="/reports/clearml_screens/clearml_5.png"><img src="/reports/clearml_screens/clearml_5.png" style="width: 500px; max-width: 100%; height: auto" title="Click for the larger version." /></a>


2. Результат "правильного" эксперимента, при равных размерах картинок. Представлен ниже. Как говорится ЧТД.
<a href="/reports/clearml_screens/clearml_6.png"><img src="/reports/clearml_screens/clearml_6.png" style="width: 500px; max-width: 100%; height: auto" title="Click for the larger version." /></a>

**Примечание**: Еще один момент, который был упущен из виду. Это то, что при помощи **torchgeo** мы можем подавать все данные без исключения, а в классическом случае, если размер спутникового снимка не делиться **нацело** на размер подаваемого мини-изображения в модель при обучении, то придется или "удалять обрезки", или придумывать "велосипед" с дорисовкой обрезкам недостоющих зон(к примеру заполнение нулями недостоющих пикселей).

В нашем проекте пришлось удалить часть обрезков (около 10%), так как торч ругается на них 8(

<a href="/references/helpers/проблема размерности картинок.png"><img src="/references/helpers/проблема размерности картинок.png" style="width: 500px; max-width: 100%; height: auto" title="Click for the larger version." /></a>
